g.clear();Graphics.prototype.setFont7x11Numeric7Seg=function(){this.setFontCustom(atob("ACAB70AYAwBgC94AAAAAAAAAAB7wAAPQhhDCGELwAAAAhDCGEMIXvAAeACAEAIAQPeAA8CEMIYQwhA8AB70IYQwhhCB4AAAIAQAgBAB7wAHvQhhDCGEL3gAPAhDCGEMIXvAAe9CCEEIIQPeAA94EIIQQghA8AB70AYAwBgCAAAAHgQghBCCF7wAHvQhhDCGEIAAAPehBCCEEIAAAAA=="),46,atob("AgAHBwcHBwcHBwcHAAAAAAAAAAcHBwcHBw=="),11)};
var DEFAULT_SELECTION="0",BOTTOM_MARGIN=10,RIGHT_MARGIN=20,COLORS={DEFAULT:["#7F8183","#A6A6A7"],OPERATOR:["#F99D1C","#CA7F2A"],SPECIAL:["#65686C","#7F8183"]},keys={0:{xy:[0,200,120,240]},".":{xy:[120,200,180,240]},"=":{xy:[181,200,240,240],color:COLORS.OPERATOR},1:{xy:[0,160,60,200]},2:{xy:[60,160,120,200]},3:{xy:[120,160,180,200]},"+":{xy:[181,160,240,200],color:COLORS.OPERATOR},4:{xy:[0,120,60,160]},5:{xy:[60,120,120,160]},6:{xy:[120,120,180,160]},"-":{xy:[181,120,240,160],color:COLORS.OPERATOR},
7:{xy:[0,80,60,120]},8:{xy:[60,80,120,120]},9:{xy:[120,80,180,120]},"*":{xy:[181,80,240,120],color:COLORS.OPERATOR},R:{xy:[0,40,60,79],color:COLORS.SPECIAL,val:"AC"},N:{xy:[60,40,120,79],color:COLORS.SPECIAL,val:"+/-"},"%":{xy:[120,40,180,79],color:COLORS.SPECIAL},"/":{xy:[181,40,240,79],color:COLORS.OPERATOR}},selected=DEFAULT_SELECTION,prevNumber=null,currNumber=null,operator=null,results=null,isDecimal=!1,hasPressedEquals=!1;
function drawKey(a,b,c){var d=0,e=0;g.setColor((b.color||COLORS.DEFAULT)[c?1:0]);g.setFont("Vector",20);g.fillRect(b.xy[0],b.xy[1],b.xy[2],b.xy[3]);g.setColor(-1);"0"==a?d=2*RIGHT_MARGIN-7:"/"===a?d=5:"*"===a?(e=5,d=3):"-"===a?d=3:"R"===a||"N"===a?d="C"===b.val?0:-9:"%"===a&&(d=-3);g.drawString(b.val||a,b.xy[0]+RIGHT_MARGIN+d,b.xy[1]+BOTTOM_MARGIN+e)}function getIntWithPrecision(a){a=a.toString();var b=a.indexOf(".");b=-1===b?0:a.length-b-1;return{num:Number(a.replace(".","")),p:b}}
function multiply(a,b){var c=getIntWithPrecision(a),d=getIntWithPrecision(b);return c.num*d.num/Math.pow(10,c.p+d.p)}function divide(a,b){var c=getIntWithPrecision(a),d=getIntWithPrecision(b);return c.num/d.num/Math.pow(10,c.p-d.p)}function sum(a,b){var c=getIntWithPrecision(a),d=getIntWithPrecision(b),e=Math.abs(c.p-d.p);0<e&&(c.p>d.p?d.num*=Math.pow(10,e):c.num*=Math.pow(10,e));return(c.num+d.num)/Math.pow(10,Math.max(c.p,d.p))}function subtract(a,b){return sum(a,-b)}
function doMath(a,b,c){switch(c){case "/":return divide(a,b);case "*":return multiply(a,b);case "+":return sum(a,b);case "-":return subtract(a,b)}}
function displayOutput(a){var b=0;g.setColor(0);g.fillRect(0,0,240,39);g.setColor(-1);if(Infinity===a||-Infinity===a||isNaN(a)){Infinity===a?a="INFINITY":-Infinity===a?a="-INFINITY":(a="NOT A NUMBER",b=-25);var c=(a+"").length;results=currNumber=null;hasPressedEquals=isDecimal=!1;operator=prevNumber=null;keys.R.val="AC";drawKey("R",keys.R);g.setFont("Vector",22)}else{var d=Number(a);if("string"===typeof a)if(-1!==a.indexOf("."))0==d&&(a="0.");else for(;1<a.length&&"0"===a[0];)a=a.substr(1);c=(a+"").length;
if(0>d||0===d&&-Infinity===1/d)g.setFont("Vector",20),g.drawString("-",220-15*c,10),b=15;g.setFont("7x11Numeric7Seg",2)}g.drawString(a,220-15*c+b,10)}var wasPressedEquals=!1,hasPressedNumber=!1;
function calculatorLogic(a){wasPressedEquals&&!1!==hasPressedNumber?(prevNumber=null,currNumber=hasPressedNumber,hasPressedNumber=wasPressedEquals=!1):(hasPressedEquals&&(hasPressedNumber?(prevNumber=null,hasPressedNumber=!1,operator=null):(currNumber=null,prevNumber=results),hasPressedEquals=!1,wasPressedEquals=!0),null==currNumber&&null!=operator&&-1!=="/*-+".indexOf(a)?(operator=a,displayOutput(prevNumber)):null!=prevNumber&&null!=currNumber&&null!=operator?(results=doMath(prevNumber,currNumber,
operator),operator=a,prevNumber=results,currNumber=null,displayOutput(results)):null==prevNumber&&null!=currNumber&&null==operator?(operator=a,prevNumber=currNumber,currNumber=null,displayOutput(prevNumber)):null==prevNumber&&null==currNumber&&null==operator&&displayOutput(0))}
function buttonPress(a){switch(a){case "R":results=currNumber=null;hasPressedEquals=isDecimal=!1;"AC"==keys.R.val?operator=prevNumber=null:(keys.R.val="AC",drawKey("R",keys.R,!0));hasPressedNumber=wasPressedEquals=!1;displayOutput(0);break;case "%":null!=results?displayOutput(results/=100):null!=currNumber&&displayOutput(currNumber/=100);hasPressedNumber=!1;break;case "N":null!=results?displayOutput(results*=-1):displayOutput(currNumber*=-1);break;case "/":case "*":case "-":case "+":calculatorLogic(a);
hasPressedNumber=!1;break;case ".":keys.R.val="C";drawKey("R",keys.R);isDecimal=!0;displayOutput(null==currNumber?"0.":currNumber+".");break;case "=":null!=prevNumber&&null!=currNumber&&null!=operator&&(prevNumber=results=doMath(prevNumber,currNumber,operator),displayOutput(results),hasPressedEquals=1);hasPressedNumber=!1;break;default:keys.R.val="C";drawKey("R",keys.R);var b=0===currNumber&&-Infinity===1/currNumber;isDecimal?(currNumber=null==currNumber||1===hasPressedEquals?"0."+a:currNumber+"."+
a,isDecimal=!1):currNumber=null==currNumber||1===hasPressedEquals?a:b?"-"+a:currNumber+a;1===hasPressedEquals&&(hasPressedEquals=2);hasPressedNumber=currNumber;displayOutput(currNumber)}}function isPressed(a,b){var c=keys[a].xy;return b.x>c[0]&&b.y>c[1]&&b.x<c[2]&&b.y<c[3]?(drawKey(a,keys[a],!0),setTimeout(function(){drawKey(a,keys[a],!1)},200),selected=a,!0):!1}TC.on("touch",function(a){for(var b in keys)isPressed(b,a)&&buttonPress(b.toString())});
function initdraw(){for(var a in keys)drawKey(a,keys[a],!1);g.setFont("7x11Numeric7Seg",2.8);g.drawString("0",205,10)}setTimeout(initdraw,500);